<form [formGroup]="newFacetForm" (submit)="addFacet()">
  <mat-form-field>
    <input matInput [formControl]="newFacetId" placeholder="facet ID" />
    <mat-error
      *ngIf="
        newFacetId.errors?.required && (newFacetId.dirty || newFacetId.touched)
      "
      >ID required</mat-error
    >
    <mat-error
      *ngIf="
        newFacetId.errors?.maxLength && (newFacetId.dirty || newFacetId.touched)
      "
      >ID too long</mat-error
    >
    <mat-error
      *ngIf="
        newFacetId.errors?.pattern && (newFacetId.dirty || newFacetId.touched)
      "
      >invalid ID</mat-error
    >
  </mat-form-field>
  <button mat-icon-button color="primary" (click)="addFacet()">
    <mat-icon>add_circle</mat-icon>
    add facet
  </button>
</form>
<div *ngIf="facets">
  <mat-tab-group [(selectedIndex)]="tabIndex">
    <!-- list -->
    <mat-tab label="list">
      <cadmus-facet-view
        *ngFor="let f of facets"
        [facet]="f"
        (editFacetMetadata)="onEditFacet($event)"
        (viewPartInfo)="onViewPartInfo($event)"
        (facetChange)="onFacetChange($event)"
        (editPart)="onEditPart($event)"
      ></cadmus-facet-view>

      <!-- info -->
      <cadmus-part-info [model]="currentModel"></cadmus-part-info>
    </mat-tab>

    <!-- facet editor -->
    <mat-tab label="facet" *ngIf="editedFacet">
      <cadmus-facet-metadata-editor
        [facet]="editedFacet"
        (facetChange)="onFacetChange($event)"
        (editorClose)="onFacetEditorClose()"
      ></cadmus-facet-metadata-editor>
    </mat-tab>

    <!-- part editor -->
    <mat-tab label="part" *ngIf="editedPart">
      <cadmus-part-definition-editor
        [definition]="editedPart"
      ></cadmus-part-definition-editor>
    </mat-tab>
  </mat-tab-group>
</div>
