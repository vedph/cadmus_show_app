<div *ngIf="node">
  <!-- display -->
  <div *ngIf="!editing" [style.marginLeft]="node.level + 'em'" class="node">
    <!-- buttons -->
    <button
      type="button"
      mat-icon-button
      color="primary"
      matTooltip="Edit this entry"
      (click)="toggleEdit(true)"
    >
      <mat-icon>edit</mat-icon>
    </button>
    <button
      type="button"
      mat-icon-button
      *ngIf="node.level"
      matTooltip="Promote this entry"
    >
      <mat-icon>arrow_back</mat-icon>
    </button>
    <button
      type="button"
      mat-icon-button
      matTooltip="Make this entry child of the preceding one"
    >
      <mat-icon>subdirectory_arrow_right</mat-icon>
    </button>
    <button type="button" mat-icon-button matTooltip="Move this entry up">
      <mat-icon>arrow_upward</mat-icon>
    </button>
    <button type="button" mat-icon-button matTooltip="Move this entry down">
      <mat-icon>arrow_downward</mat-icon>
    </button>
    <button
      type="button"
      mat-icon-button
      color="warn"
      matTooltip="Delete this entry"
    >
      <mat-icon>remove_circle</mat-icon>
    </button>
    <span class="node-id">{{ node.id }}</span>
    <span class="node-value">{{ node.value }}</span>
  </div>

  <!-- edit -->
  <div *ngIf="editing">
    <form [formGroup]="form" (submit)="save()">
      <!-- id -->
      <mat-form-field>
        <input matInput [formControl]="id" placeholder="id" />
        <mat-error *ngIf="id.errors?.required && (id.dirty || id.touched)"
          >ID required</mat-error
        >
        <mat-error *ngIf="id.errors?.maxLength && (id.dirty || id.touched)"
          >ID too long</mat-error
        >
        <mat-error *ngIf="id.errors?.pattern && (id.dirty || id.touched)"
          >invalid ID</mat-error
        >
      </mat-form-field>

      <!-- value -->
      &nbsp;
      <mat-form-field>
        <input matInput [formControl]="value" placeholder="value" />
        <mat-error
          *ngIf="value.errors?.required && (value.dirty || value.touched)"
          >value required</mat-error
        >
        <mat-error
          *ngIf="value.errors?.maxLength && (value.dirty || value.touched)"
          >value too long</mat-error
        >
      </mat-form-field>

      &nbsp;
      <button
        type="button"
        mat-icon-button
        color="warn"
        matTooltip="Discard changes"
        (click)="toggleEdit(false)"
      >
        <mat-icon>clear</mat-icon>
      </button>
      <button
        type="submit"
        mat-icon-button
        [disabled]="form.pristine || form.invalid"
        color="primary"
        matTooltip="Save changes"
      >
        <mat-icon>check_circle</mat-icon>
      </button>
    </form>
  </div>
</div>
